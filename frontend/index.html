<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>WAVE PREDICTOR | 適正スクレイピング対応版</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <meta name="description" content="適正スクレイピング対応版。手動更新・キャッシュ優先で安全運用。">
    <meta name="keywords" content="競艇,予想,AI,適正スクレイピング,手動更新">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="container header-inner">
            <a href="#" class="logo">
                <i class="fas fa-water"></i>
                WAVE PREDICTOR
                <span class="version-badge">適正版</span>
            </a>
            <nav>
                <ul>
                    <li><a href="#predictions">今日の予想</a></li>
                    <li><a href="#ai-predictions">AI分析</a></li>
                    <li><a href="#system-status">システム状況</a></li>
                    <li><a href="#about-ai">AIモデル</a></li>
                    <li><a href="#signup">会員登録</a></li>
                </ul>
            </nav>
            <button class="mobile-menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <section class="hero">
        <div class="hero-particles">
            <!-- パーティクルはJavaScriptで生成 -->
        </div>
        <div class="hero-content">
            <h1>適正スクレイピング対応<br>安全な競艇予想AI</h1>
            <p>手動更新・キャッシュ優先システムで、サーバーに負荷をかけず安全に運用。正式な出走表データを適正な頻度で取得します。</p>
            <a href="#predictions" class="btn btn-large">
                <i class="fas fa-shield-alt"></i>
                安全な予想を見る
            </a>
        </div>
    </section>

    <section class="features scroll-animate">
        <div class="container">
            <h2 class="section-title">適正スクレイピング対応の特徴</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-hand-paper"></i>
                    </div>
                    <div class="feature-content">
                        <h3>手動更新システム</h3>
                        <p>5分間隔の自動更新を停止し、必要な時のみ手動でデータを更新。サーバー負荷を大幅に軽減し、安全な運用を実現します。</p>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="feature-content">
                        <h3>キャッシュ優先モード</h3>
                        <p>一度取得したデータをキャッシュに保存し、新しいリクエスト時は可能な限りキャッシュから返却。無駄なスクレイピングを回避します。</p>
                    </div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div class="feature-content">
                        <h3>適正アクセス頻度</h3>
                        <p>1日最大50回の制限により、ボット検知を回避。5秒間隔でのアクセスで、競艇公式サイトへの負荷を最小限に抑制します。</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="system-status" id="system-status">
        <div class="container">
            <h2 class="section-title">🔧 システム運用状況</h2>
            
            <!-- システム状況ダッシュボード -->
            <div class="status-dashboard">
                <div class="status-cards">
                    <div class="status-card">
                        <div class="status-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="status-content">
                            <h3>スクレイピング状況</h3>
                            <div id="scraping-status" class="status-indicator status-loading">
                                <i class="fas fa-spinner fa-spin"></i> 
                                確認中...
                            </div>
                            <div class="status-details">
                                <span id="scraping-count">今日: --/50回</span>
                                <span id="scraping-mode">モード: 確認中</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="status-content">
                            <h3>最終更新時刻</h3>
                            <div class="status-time">
                                <span id="last-updated">--:--:--</span>
                            </div>
                            <div class="status-details">
                                <span id="data-source-info">データソース: キャッシュ優先</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <div class="status-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="status-content">
                            <h3>安全運用</h3>
                            <div class="status-indicator status-success">
                                <i class="fas fa-check-circle"></i>
                                適正運用中
                            </div>
                            <div class="status-details">
                                <span>自動更新: 停止</span>
                                <span>手動更新: 有効</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 手動更新コントロール -->
                <div class="manual-update-controls">
                    <button id="manual-refresh-btn" class="btn btn-primary btn-large">
                        <i class="fas fa-sync-alt"></i>
                        手動データ更新
                    </button>
                    <button id="system-status-btn" class="btn btn-secondary">
                        <i class="fas fa-info-circle"></i>
                        システム状況確認
                    </button>
                </div>
                
                <!-- 運用指針 -->
                <div class="operation-guidelines">
                    <h4><i class="fas fa-lightbulb"></i> 適正運用のポイント</h4>
                    <ul>
                        <li><strong>手動更新:</strong> 必要な時のみ「手動データ更新」ボタンを使用</li>
                        <li><strong>キャッシュ活用:</strong> 一度取得したデータは自動でキャッシュされます</li>
                        <li><strong>適正頻度:</strong> 1日50回以内の制限で安全運用</li>
                        <li><strong>緊急時:</strong> システム過負荷時は自動的にキャッシュオンリーモードに移行</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section class="predictions" id="predictions">
        <div class="container">
            <h2 class="section-title">🏁 正式出走表（手動更新）</h2>
            
            <!-- データ状況表示（更新版） -->
            <div class="data-status">
                <span id="status-indicator" class="status-indicator status-loading">
                    <i class="fas fa-spinner fa-spin"></i> 
                    データ読み込み中...
                </span>
                <div class="update-info">
                    <span class="update-mode">更新方式: 手動更新のみ</span>
                    <span class="cache-mode">データ: キャッシュ優先</span>
                </div>
            </div>

            <!-- Loading State -->
            <div id="loading" class="loading">
                <i class="fas fa-database"></i>
                <p>正式データを取得中（キャッシュ優先）...</p>
            </div>

            <!-- Error State -->
            <div id="error" class="error" style="display: none;">
                <h3><i class="fas fa-exclamation-triangle"></i> データ取得エラー</h3>
                <p id="error-message">データの取得に失敗しました。手動更新を試してください。</p>
                <button class="btn" onclick="app.ui.manualRefresh()">
                    <i class="fas fa-sync-alt"></i> 手動更新
                </button>
            </div>

            <!-- Race Info -->
            <div id="race-info" class="race-info" style="display: none;">
                <!-- 会場選択UI（更新版） -->
                <div class="venue-race-selector">
                    <h3 class="selector-title">
                        <i class="fas fa-map-marker-alt"></i> 
                        競艇場選択（正式データ）
                    </h3>
                    <div class="selector-subtitle">
                        <i class="fas fa-info-circle"></i>
                        正式な出走表とレース時間を表示
                    </div>
                    
                    <div class="venue-grid" id="venue-grid">
                        <!-- 競技場カードが動的に挿入される -->
                    </div>
                    
                    <div class="race-selector" id="race-selector" style="display: none;">
                        <h4 class="selector-subtitle">
                            <i class="fas fa-flag-checkered"></i> 
                            レース選択（実際の開始時間）
                        </h4>
                        <div class="race-buttons" id="race-buttons">
                            <!-- レースボタンが動的に挿入される -->
                        </div>
                    </div>
                    
                    <div class="selected-info" id="selected-info">
                        <div class="selected-venue">
                            <i class="fas fa-location-dot"></i>
                            <span id="selected-venue-name">会場を選択してください</span>
                        </div>
                        <div class="selected-race">
                            <i class="fas fa-trophy"></i>
                            <span id="selected-race-info">レースを選択してください</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 出走表表示（データソース表示付き） -->
            <div id="prediction-container" style="display: none;">
                <div class="race-entry-table">
                    <div class="table-header">
                        <div class="header-cell">枠</div>
                        <div class="header-cell">選手情報（正式データ）</div>
                        <div class="header-cell">詳細</div>
                        <div class="header-cell">機力</div>
                        <div class="header-cell">調子</div>
                    </div>
                    <div class="table-body" id="racers-tbody-new">
                        <!-- 選手データが動的に挿入される -->
                    </div>
                </div>

                <!-- 展示タイム表示 -->
                <div class="exhibition-times">
                    <div class="exhibition-header">
                        <i class="fas fa-stopwatch"></i>
                        展示タイム（予想値）
                        <span class="data-note">※実際の展示タイムは直前情報で更新されます</span>
                    </div>
                    <div class="exhibition-grid" id="exhibition-grid">
                        <!-- 展示タイムが動的に挿入される -->
                    </div>
                </div>

                <!-- 更新コントロール（改良版） -->
                <div class="update-controls">
                    <div class="control-buttons">
                        <button class="btn btn-primary" onclick="app.ui.manualRefresh()">
                            <i class="fas fa-sync-alt"></i> 
                            手動データ更新
                        </button>
                        <button class="btn btn-secondary" onclick="app.loadAIPrediction()">
                            <i class="fas fa-robot"></i> 
                            AI予想更新
                        </button>
                    </div>
                    <div class="last-updated">
                        <div class="update-summary">
                            <strong>運用状況:</strong> 適正スクレイピング | 
                            <strong>更新方式:</strong> 手動のみ | 
                            <strong>最終更新:</strong> <span id="last-updated-time">--:--:--</span>
                        </div>
                        <div class="data-source-summary">
                            <i class="fas fa-database"></i> データソース: <span id="current-data-source">キャッシュ優先</span> |
                            <i class="fas fa-shield-alt"></i> 安全運用: 有効
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- AI予想結果セクション -->
    <section class="ai-predictions" id="ai-predictions">
        <div class="container">
            <h2 class="section-title">🤖 AI予想結果（手動更新）</h2>
            
            <div class="ai-hero">
                <div class="ai-brain-animation">
                    <i class="fas fa-brain"></i>
                </div>
                <h3>適正運用ディープラーニングAI</h3>
                <p>手動更新により負荷を抑えながら高精度予測を提供</p>
            </div>
            
            <!-- AI予想カード -->
            <div class="prediction-cards">
                <!-- 勝率予測カード -->
                <div class="prediction-card win-prediction">
                    <div class="card-header">
                        <h3><i class="fas fa-trophy"></i> 勝率予測</h3>
                        <span class="confidence-badge">信頼度: <span id="win-confidence">--</span>%</span>
                    </div>
                    <div class="card-content">
                        <div class="prediction-result">
                            <div class="predicted-winner">
                                <span class="winner-number" id="predicted-winner">-</span>
                                <span class="winner-name" id="predicted-winner-name">予測中...</span>
                            </div>
                            <div class="win-probability">
                                <span id="win-probability">--%</span>
                                <small>勝率</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 舟券推奨カード -->
                <div class="prediction-card ticket-recommendation">
                    <div class="card-header">
                        <h3><i class="fas fa-ticket-alt"></i> おすすめ舟券</h3>
                        <span class="expected-value">期待値: <span id="expected-value">--</span></span>
                    </div>
                    <div class="card-content">
                        <div class="ticket-suggestions">
                            <div class="ticket-type">
                                <label>単勝</label>
                                <span id="recommended-win">-</span>
                            </div>
                            <div class="ticket-type">
                                <label>2連単</label>
                                <span id="recommended-exacta">-→-</span>
                            </div>
                            <div class="ticket-type">
                                <label>3連単</label>
                                <span id="recommended-trifecta">-→-→-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- リスク分析カード -->
                <div class="prediction-card risk-analysis">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-line"></i> リスク分析</h3>
                    </div>
                    <div class="card-content">
                        <div class="risk-metrics">
                            <div class="risk-meter">
                                <div class="meter-label">安定性</div>
                                <div class="meter-bar">
                                    <div class="meter-fill" id="stability-meter" style="width: 0%"></div>
                                </div>
                                <span id="stability-score">--%</span>
                            </div>
                            <div class="risk-meter">
                                <div class="meter-label">波乱度</div>
                                <div class="meter-bar">
                                    <div class="meter-fill risk" id="upset-meter" style="width: 0%"></div>
                                </div>
                                <span id="upset-score">--%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI予想更新ボタン（手動） -->
            <div class="ai-controls">
                <button class="btn btn-primary ai-update-btn" onclick="updateAIPrediction()">
                    <i class="fas fa-robot"></i> 
                    AI予想を手動更新
                </button>
                <div class="ai-status">
                    <span id="ai-last-updated">最終更新: --:--:--</span> | 
                    <span class="ai-mode">更新方式: 手動</span>
                </div>
            </div>
        </div>
    </section>

    <section class="statistics scroll-animate" id="statistics">
        <div class="container">
            <h2 class="section-title">適正運用統計</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">1日50回</div>
                    <div class="stat-label">適正アクセス制限</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5秒間隔</div>
                    <div class="stat-label">安全アクセス間隔</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">キャッシュ優先</div>
                    <div class="stat-label">データ取得方式</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">手動更新</div>
                    <div class="stat-label">更新システム</div>
                </div>
            </div>
        </div>
    </section>

    <section class="about-ai scroll-animate" id="about-ai">
        <div class="container">
            <h2 class="section-title">適正運用AIシステム</h2>
            <div class="ai-content">
                <div class="ai-image">
                    <img src="https://placehold.co/600x400/0066cc/ffffff?text=Optimized+AI" alt="適正AI分析イメージ">
                </div>
                <div class="ai-text">
                    <h3>適正スクレイピングAI</h3>
                    <p>WAVE PREDICTORの適正版AIは、手動更新とキャッシュ優先システムにより、サーバー負荷を最小限に抑えながら高精度な予測を提供します。</p>
                    <p>1日最大50回のアクセス制限、5秒間隔のリクエスト間隔により、競艇公式サイトへの負荷を軽減し、持続可能な運用を実現しています。</p>
                    
                    <div class="optimization-meter">
                        <div class="optimization-fill"></div>
                        <div class="optimization-text">95% 負荷軽減</div>
                    </div>
                    
                    <p>キャッシュファーストアプローチにより、一度取得したデータを有効活用し、無駄なスクレイピングを回避。ユーザー体験を維持しながら適正運用を実現します。</p>
                </div>
            </div>
        </div>
    </section>

    <section class="signup" id="signup">
        <div class="signup-content">
            <h2>適正版利用登録</h2>
            <p>適正スクレイピング対応版のWAVE PREDICTORをご利用ください。安全で持続可能な競艇予想AIを体験いただけます。</p>
            <form class="signup-form">
                <input type="email" placeholder="メールアドレスを入力してください" required>
                <button type="submit">
                    <i class="fas fa-shield-alt"></i>
                    適正版に登録
                </button>
            </form>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>適正運用</h3>
                    <ul>
                        <li><a href="#">手動更新システム</a></li>
                        <li><a href="#">キャッシュ優先モード</a></li>
                        <li><a href="#">適正アクセス制限</a></li>
                        <li><a href="#">安全運用ガイド</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>サポート</h3>
                    <ul>
                        <li><a href="#">ヘルプセンター</a></li>
                        <li><a href="#">よくある質問</a></li>
                        <li><a href="#">お問い合わせ</a></li>
                        <li><a href="#">利用規約</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>会社情報</h3>
                    <ul>
                        <li><a href="#">運営会社</a></li>
                        <li><a href="#">プライバシーポリシー</a></li>
                        <li><a href="#">特定商取引法</a></li>
                        <li><a href="#">採用情報</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>フォローする</h3>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 WAVE PREDICTOR 適正スクレイピング版 All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>
